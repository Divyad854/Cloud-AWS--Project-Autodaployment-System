# infra/nginx.conf
# Nginx reverse proxy for CloudLaunch deployed apps

events {
    worker_connections 1024;
}

http {
    # Default: route by subdomain or path
    server {
        listen 80;
        server_name _;

        # Health check
        location /nginx-health {
            return 200 "ok";
            add_header Content-Type text/plain;
        }

        # Dynamic routing: /app/{projectId}/ â†’ container port
        # This is a simplified config; use a Lua or map block for dynamic ports
        location / {
            return 404 "No app configured for this route";
        }
    }
}

# Per-project configs are generated dynamically and included here:
# include /etc/nginx/conf.d/*.conf;
